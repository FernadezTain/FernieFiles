<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>FernieX - Files</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>FernieX - Files</h1>

<div class="container">
    <div class="products" id="products"></div>
</div>

<script src="animation.js"></script>
<script>
const list = document.getElementById('products');

fetch('data.json')
.then(r => r.json())
.then(data => {
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
    data.products.forEach(p => {
        const viewed = localStorage.getItem('viewed_' + p.id);
        const label = viewed ? 'üëÅ viewed' : 'new';

        list.innerHTML += `
            <a href="product.html?id=${p.id}" class="product">
                <div class="badge">${label}</div>
                <img src="${p.images[0]}">
                <h3>${p.name}</h3>
            </a>
        `;
    });

    // –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∏–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ)
    list.addEventListener('click', e => {
        const card = e.target.closest('.product');
        if (!card) return;

        // –î–ª—è —Å—Å—ã–ª–æ–∫ —Å—Ä–∞–∑—É –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç–æ–≤–∞—Ä–∞
        if (card.tagName.toLowerCase() === 'a') return;

        e.preventDefault();

        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –¥—Ä—É–≥–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏
        document.querySelectorAll('.product.active').forEach(activeCard => {
            if (activeCard !== card) activeCard.classList.remove('active');
        });

        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–µ–π
        card.classList.toggle('active');
    });
});
</script>
</body>
</html>
